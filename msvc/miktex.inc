## miktex.inc: MiKTeX -*- Makefile -*- variables for Microsoft C++ 8.0
## 
## Copyright (C) 1996-2006 Christian Schenk
## 
## This file is free software; you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published
## by the Free Software Foundation; either version 2, or (at your
## option) any later version.
## 
## This file is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
## 
## You should have received a copy of the GNU General Public License
## along with this file; if not, write to the Free Software
## Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307,
## USA.

## See file win\README.win for build instructions.

!ifndef srcdir
srcdir = .
!endif

#  ___________________________________________________________________________
#
#  Version Information
#
#  version.inc is generated by configure.cmd.
#  ___________________________________________________________________________

!include <config.inc>

#  ___________________________________________________________________________
#
#  Meta Settings
#  ___________________________________________________________________________

!ifndef miktex_whole_program_optimization
miktex_whole_program_optimization = 1
!endif

!ifndef miktex_cc_maximize_speed
miktex_cc_maximize_speed = 1
!endif

!ifndef miktex_cc_minimize_size
miktex_cc_minimize_size = 0
!endif

!ifndef miktex_cc_disable_optimization
miktex_cc_disable_optimization = 0
!endif

!ifndef miktex_cc_buffer_security_check
miktex_cc_buffer_security_check = 0
!endif

!ifndef miktex_cc_warnings_as_errors
miktex_cc_warnings_as_errors = 0
!endif

!ifndef miktex_cc_64bit_portability
miktex_cc_64bit_portability = 1
!endif

!ifndef miktex_cc_no_warnings
miktex_cc_no_warnings = 0
!endif

!ifndef miktex_prf
miktex_prf = 0
!endif

!ifndef miktex_cc_no_runtime_checks
miktex_cc_no_runtime_checks = 0
!endif

!ifndef miktex_cc_use_crt_dll
miktex_cc_use_crt_dll = 1
!endif

!ifndef miktex_cc_64bit_portability
miktex_cc_64bit_portability = 0
!endif

!ifndef miktex_cc_for_loop_conformance
miktex_cc_for_loop_conformance = 0
!endif

!ifndef miktex_cc_standard_conformance
miktex_cc_standard_conformance = 0
!endif

#  ___________________________________________________________________________
#
#  Processor Architecture
#  One of: x86 amd64
#  ___________________________________________________________________________

!ifndef ARCH
ARCH = x86
!endif

!if ("$(ARCH)" != "x86") && ("$(ARCH)" != "amd64")
!error only x86 and amd64 are supported
!endif

#  ___________________________________________________________________________
#
#  Compiler Version
#  ___________________________________________________________________________

## compiler version (_MSC_VER)
!ifndef MSCVER
MSCVER = 1400
!endif

#  ___________________________________________________________________________
#
#  Source Tree Structure
#  ___________________________________________________________________________

rel_configfilesdir = Admin\ConfigFiles
rel_defaultsdir = Admin\Defaults

rel_applibdir =	Libraries\MiKTeX\App
rel_arctrldir =	Programs\MiKTeX\arctrl\win
rel_bibtex8dir = Programs\Bibliography\bibtex8
rel_bibtexdir = Programs\Bibliography\bibtex
rel_bmepslibdir = Libraries\3rd\libbmeps
rel_buildtoolsetcdir = BuildUtilities\etc
rel_bzip2dir = Libraries\3rd\bzip2
rel_bzip2staticdir = Libraries\3rd\bzip2-static
rel_c4pdir = BuildUtilities\c4p
rel_cfgdir = BuildUtilities\cfg
rel_cjkutilsdir = Programs\FontUtilities\cjkutils
rel_curllibdir = Libraries\3rd\libcurl
rel_curlstaticlibdir = Libraries\3rd\libcurl-static
rel_cwebdir = BuildUtilities\cweb
rel_diblibdir = Libraries\MiKTeX\Dib
rel_docdir = Documentation
rel_dvicopydir = Programs\DviWare\dvicopy
rel_dvilibdir = Libraries\MiKTeX\Dvi
rel_dvipdfmdir = Programs\DviWare\dvipdfm
rel_dvipdfmxdir = Programs\DviWare\dvipdfmx
rel_dvipngdir = Programs\DviWare\dvipng
rel_dvipskdir = Programs\DviWare\dvips
rel_dvispooldir = Programs\MiKTeX\mtprint
rel_epstopdfdir = Programs\MiKTeX\epstopdf
rel_etcdir = Programs\MiKTeX\etc
rel_etcsrcdir = Libraries\MiKTeX\etc
rel_etexdir = Programs\TeXAndFriends\etex
rel_expatlibdir = Libraries\3rd\libexpat
rel_expatstaticlibdir = Libraries\3rd\libexpat-static
rel_findtexmfdir = Programs\MiKTeX\findtexmf
rel_fofistaticlibdir = Programs\TeXAndFriends\pdftex\xpdf\fofi
rel_freetypedir = Programs\FontUtilities\freetype
rel_freetypelibdir = $(rel_freetypedir)\lib
rel_gdlibdir = Libraries\3rd\libgd
rel_gnulibdir = Libraries\3rd\libgnu
rel_gnustaticlibdir = Libraries\3rd\libgnu-static
rel_goostaticlibdir = Programs\TeXAndFriends\pdftex\xpdf\goo
rel_gsf2pkdir = Programs\MiKTeX\gsf2pk
rel_gsoapdir = Libraries\3rd\gsoap
rel_gsoapstaticdir = Libraries\3rd\gsoap-static
rel_initexmfdir = Programs\MiKTeX\initexmf
rel_jpeglibdir = Libraries\3rd\libjpeg
rel_kpslibdir = Libraries\MiKTeX\KPathSeaEmulation
rel_libdir = Libraries\MiKTeX\Core
rel_makeindexdir = Programs\Indexing\makeindex
rel_makexlibdir = Programs\MiKTeX\makex
rel_mcdlibdir = Programs\MiKTeX\texify
rel_md5libdir = Libraries\3rd\libmd5
rel_md5staticlibdir = Libraries\3rd\libmd5-static
rel_md5walkdir = BuildUtilities\md5walk
rel_mfdir = Programs\TeXAndFriends\mf
rel_mfwaredir = Programs\TeXAndFriends\mfware
rel_migratedir = Programs\MiKTeX\migrate
rel_mikuilibdir = Libraries\MiKTeX\UI\MFC
rel_mkfntmapdir = Programs\MiKTeX\mkfntmap
rel_modir = Programs\MiKTeX\MO\MFC
rel_mpcdir = BuildUtilities\mpc
rel_mpdir = Programs\TeXAndFriends\mpost\mp
rel_mpmcondir = Programs\MiKTeX\PackageManager\mpm
rel_mpmdir = Programs\MiKTeX\PackageManager\MFC
rel_mpmlibdir = Libraries\MiKTeX\PackageManager
rel_mpmstaticlibdir = Libraries\MiKTeX\PackageManager-static
rel_mpwaredir = Programs\TeXAndFriends\mpost\mpware
rel_mspacklibdir = Libraries\3rd\libmspack
rel_mspackstaticlibdir = Libraries\3rd\libmspack-static
rel_mthelplibdir = Programs\MiKTeX\mthelp
rel_netpbmdir = Libraries\3rd\netpbm
rel_omegadir = Programs\TeXAndFriends\omega\omega
rel_omegawaredir = Programs\TeXAndFriends\omega\omegaware
rel_otpsdir = Programs\TeXAndFriends\omega\otps
rel_pbmlibdir = $(rel_netpbmdir)\pbm
rel_pdfetexdir = Programs\TeXAndFriends\pdfetex
rel_pdftexdir = Programs\TeXAndFriends\pdftex
rel_pgmlibdir = $(rel_netpbmdir)\pgm
rel_pnglibdir = Libraries\3rd\libpng
rel_pnmlibdir = $(rel_netpbmdir)\pnm
rel_pnmtopngdir = Programs\GraphicsUtilities\pnmtopng
rel_poptlibdir = Libraries\3rd\libpopt
rel_poptstaticlibdir = Libraries\3rd\libpopt-static
rel_ppmlibdir = $(rel_netpbmdir)\ppm
rel_ps2pkdir = Programs\FontUtilities\ps2pk
rel_psutilsdir = Programs\GraphicsUtilities\psutils
rel_removewizdir = Programs\MiKTeX\Wizards\Remove\MFC
rel_setupwizdir = Programs\MiKTeX\Wizards\Setup\MFC
rel_staticlibdir = Libraries\MiKTeX\Core-static
rel_tex4htdir = Programs\Converters\tex4ht
rel_texdir = Programs\TeXAndFriends\tex
rel_texdocdir = Programs\MiKTeX\mthelp
rel_texetcdir = Programs\TeXAndFriends\etc
rel_texinfodir = Programs\Converters\texinfo
rel_texmflibdir = Libraries\MiKTeX\TeXAndFriends
rel_texwaredir = Programs\TeXAndFriends\texware
rel_tiedir =  BuildUtilities\tie
rel_tifflibdir = Libraries\3rd\libtiff
rel_updatewizdir = Programs\MiKTeX\Wizards\Update\MFC
rel_webdir = Programs\TeXAndFriends\web
rel_wsclientdir = Libraries\MiKTeX\WebServiceClients
rel_xpdfstaticlibdir = Programs\TeXAndFriends\pdftex\xpdf\xpdf
rel_yapdir = Programs\MiKTeX\Yap\MFC
rel_zlibdir = Libraries\3rd\zlib
rel_zlibstaticlibdir = Libraries\3rd\zlib-static












xsldir = $(miktexsrcdir)\$(rel_docdir)\Styles
cssdir = $(miktexsrcdir)\$(rel_docdir)\Styles

applibdir = $(miktexsrcdir)\$(rel_applibdir)
arctrldir = $(miktexsrcdir)\$(rel_arctrldir)
bmepslibdir = $(miktexsrcdir)\$(rel_bmepslibdir)
bzip2dir = $(miktexsrcdir)\$(rel_bzip2dir)
bzip2staticdir = $(miktexsrcdir)\$(rel_bzip2staticdir)
curllibdir = $(miktexsrcdir)\$(rel_curllibdir)
curlstaticlibdir = $(miktexsrcdir)\$(rel_curlstaticlibdir)
diblibdir = $(miktexsrcdir)\$(rel_diblibdir)
dvilibdir = $(miktexsrcdir)\$(rel_dvilibdir)
expatlibdir = $(miktexsrcdir)\$(rel_expatlibdir)
expatstaticlibdir = $(miktexsrcdir)\$(rel_expatstaticlibdir)
fofistaticlibdir = $(miktexsrcdir)\$(rel_fofistaticlibdir)
freetypelibdir = $(miktexsrcdir)\$(rel_freetypelibdir)
gdlibdir = $(miktexsrcdir)\$(rel_gdlibdir)
gnulibdir = $(miktexsrcdir)\$(rel_gnulibdir)
gnustaticlibdir = $(miktexsrcdir)\$(rel_gnustaticlibdir)
goostaticlibdir = $(miktexsrcdir)\$(rel_goostaticlibdir)
gsoapdir = $(miktexsrcdir)\$(rel_gsoapdir)
gsoapstaticdir = $(miktexsrcdir)\$(rel_gsoapstaticdir)
jpeglibdir = $(miktexsrcdir)\$(rel_jpeglibdir)
kpslibdir = $(miktexsrcdir)\$(rel_kpslibdir)
makexlibdir = $(miktexsrcdir)\$(rel_makexlibdir)
mcdlibdir = $(miktexsrcdir)\$(rel_mcdlibdir)
md5libdir = $(miktexsrcdir)\$(rel_md5libdir)
md5staticlibdir = $(miktexsrcdir)\$(rel_md5staticlibdir)
mikuilibdir = $(miktexsrcdir)\$(rel_mikuilibdir)
mpmlibdir = $(miktexsrcdir)\$(rel_mpmlibdir)
mpmstaticlibdir = $(miktexsrcdir)\$(rel_mpmstaticlibdir)
mspacklibdir = $(miktexsrcdir)\$(rel_mspacklibdir)
mspackstaticlibdir = $(miktexsrcdir)\$(rel_mspackstaticlibdir)
mthelplibdir = $(miktexsrcdir)\$(rel_mthelplibdir)
netpbmdir = $(miktexsrcdir)\$(rel_netpbmdir)
pbmlibdir = $(miktexsrcdir)\$(rel_pbmlibdir)
pgmlibdir = $(miktexsrcdir)\$(rel_pgmlibdir)
pnglibdir = $(miktexsrcdir)\$(rel_pnglibdir)
pnmlibdir = $(miktexsrcdir)\$(rel_pnmlibdir)
poptlibdir = $(miktexsrcdir)\$(rel_poptlibdir)
poptstaticlibdir = $(miktexsrcdir)\$(rel_poptstaticlibdir)
ppmlibdir = $(miktexsrcdir)\$(rel_ppmlibdir)
texmflibdir = $(miktexsrcdir)\$(rel_texmflibdir)
tifflibdir = $(miktexsrcdir)\$(rel_tifflibdir)
wsclientdir = $(miktexsrcdir)\$(rel_wsclientdir)
xpdfstaticlibdir = $(miktexsrcdir)\$(rel_xpdfstaticlibdir)
zlibdir = $(miktexsrcdir)\$(rel_zlibdir)
zlibstaticlibdir = $(miktexsrcdir)\$(rel_zlibstaticlibdir)

libdir = $(miktexsrcdir)\$(rel_libdir)
staticlibdir = $(miktexsrcdir)\$(rel_staticlibdir)

buildtoolsetcdir = $(miktexsrcdir)\$(rel_buildtoolsetcdir)
etcsrcdir = $(miktexsrcdir)\$(rel_etcsrcdir)
webdir = $(miktexsrcdir)\$(rel_webdir)


#  ___________________________________________________________________________
#
#  Directories
#  ___________________________________________________________________________

## the staging directory
!ifndef prefix
#prefix = C:\MiKTeX-Builds\$(miktexseries)\texmf
prefix = C:\MiKTeX-Builds\2.5\texmf
!endif
destdir = $(prefix)
localtexmf = $(prefix)

## where the production version of MiKTeX is installed
!ifndef tmdir
tmdir = C:\texmf
!endif

## texmf root directories
texmfroots = $(prefix);$(tmdir)

## MiKTeX directory
miktexdir = $(prefix)\miktex

## MiKTeX bin directory
!if "$(ARCH)" == "x86"
bindir = $(miktexdir)\bin
!else
bindir = $(miktexdir)\bin\$(ARCH)
!endif

# config dir
configdir = $(miktexdir)\config

## documentation
docdir = $(prefix)\doc
miktexdocdir = $(docdir)\miktex

## sub-directory for compiler generated files
!if ($(MIKTEX_RELEASE_STATE) == 4)
!if ($(MSCVER) < 1400)
outdir = WinDebug
!else
outdir = Debug
!endif
!endif

!if ($(MIKTEX_RELEASE_STATE) < 3)
!if ($(MSCVER) < 1400)
outdir = WinRel
!else
outdir = Release
!endif
!endif

!if "$(ARCH)" != "x86"
outdir = $(ARCH)\$(outdir)
!endif

liboutdir = $(libdir)\$(outdir)

#  ___________________________________________________________________________
#
#  C/C++ Compiler
#  ___________________________________________________________________________

## name of C/C++ compiler
cc = cl

## C/C++ compiler options
ccopt_64port = /Wp64
ccopt_all_cpp = /TP
ccopt_buffer_security_check = /GS
ccopt_compile_all_files_as_cpp = /TP
ccopt_create_pdb = /Zi
ccopt_create_precompiled_header_file = /Yc
ccopt_debug_symbols_and_line_numbers = /Zd
ccopt_default_char_type_is_unsigned = /J
ccopt_default_warnings = /W3
ccopt_disable_optimizations = /Od
ccopt_disable_warnings = /W0
ccopt_eliminate_duplicate_strings = /GF
ccopt_enable_asynchronous_exception_handling = /EHac
ccopt_enable_function_level_linking = /Gy
ccopt_enable_penter_hook = /Gh
ccopt_enable_rtti_support = /GR
ccopt_enable_synchronous_exception_handling = /EHsc
ccopt_favor_small_code = /Os
ccopt_for_loop_conformance = /Zc:forScope
ccopt_link = /link
ccopt_lint_level_warnings = /W4
ccopt_maximize_speed = /O2
ccopt_minimize_size = /O1
ccopt_name_precompiled_header_file = /Fp
ccopt_output_directory = /Fo
ccopt_output_file = /Fo
ccopt_prevent_linking = /c
ccopt_quiet = /nologo
ccopt_rtc_all = /RTCsuc
ccopt_select_crt_mt_dll_debug = /MDd
ccopt_select_crt_mt_dll_retail = /MD
ccopt_select_crt_mt_static_lib_debug = /MTd
ccopt_select_crt_mt_static_lib_retail = /MT
ccopt_select_fastcall = /Gr
ccopt_standard_conformance = /Za
ccopt_use_precompiled_header_file = /Yu
ccopt_warnings_as_errors = /WX
ccopt_whole_program_optimization = /GL

# deprecated:
ccopt_enable_exception_handling = $(ccopt_enable_synchronous_exception_handling)

## Defines
ccdef_app_dll = -DAPP_DLL
ccdef_debug = -DDEBUG
ccdef_expat_dll = -DEXPAT_DLL
ccdef_final = -DFINAL
ccdef_gnu_dll = -DGNU_DLL
ccdef_gsoap_dll = -DGSOAP_DLL
ccdef_miktex = -DMIKTEX -DMIKTEX_WINDOWS
ccdef_miktex_dll = -DMIKTEX_DLL
ccdef_mpm_dll = -DMPM_DLL
ccdef_ndebug = -DNDEBUG
ccdef_official = -DOFFICIAL
ccdef_popt_dll = -DPOPT_DLL
ccdef_regex_dll = -DREGEX_DLL
ccdef_texmf_dll = -DTEXMF_DLL
ccdef_win32 = -DWIN32

## Includes
ccinc_current_dir = -I$(srcdir)
ccinc_lib = -I$(libdir)\include
ccinc_libdib = -I$(diblibdir)\include
ccinc_libdvi = -I$(dvilibdir)\include
ccinc_libapp = -I$(applibdir)\include
ccinc_libbz2 = -I$(bzip2dir)
ccinc_libcurl = -I$(curllibdir)\include
ccinc_libexpat = -I$(expatlibdir)
ccinc_libgd = -I$(gdlibdir)
ccinc_libgnu = -I$(gnulibdir)
ccinc_libkps = -I$(kpslibdir)\include
ccinc_libmd5 = -I$(md5libdir)\include
ccinc_libmikui = -I$(mikuilibdir)\include
ccinc_libmpm = -I$(mpmlibdir)\include
ccinc_libmspack = -I$(mspacklibdir)
ccinc_libpng = -I$(pnglibdir)
ccinc_libpopt = -I$(poptlibdir)
ccinc_libtexmf = -I$(texmflibdir)\include
ccinc_libpbm = -I$(miktexsrcdir:\=/)/$(rel_netpbmdir)/pbm
ccinc_libpgm = -I$(miktexsrcdir:\=/)/$(rel_netpbmdir)/pgm
ccinc_libpnm = -I$(miktexsrcdir:\=/)/$(rel_netpbmdir)/pnm
ccinc_libppm = -I$(miktexsrcdir:\=/)/$(rel_netpbmdir)/ppm
ccinc_netpbm = -I$(miktexsrcdir:\=/)/$(rel_netpbmdir)
ccinc_zlib = -I$(zlibdir)
ccinc_gsoap = -I$(gsoapdir)

## optimization flags
!if $(miktex_cc_disable_optimization) > 0
coptflags = $(ccopt_disable_optimizations)
!else if $(miktex_cc_maximize_speed) > 0
coptflags = $(ccopt_maximize_speed)
!else if $(miktex_cc_minimize_size) > 0
coptflags = $(ccopt_minimize_size) $(ccopt_favor_small_code)
!endif
!if $(miktex_whole_program_optimization) > 0
coptflags = $(coptflags) $(ccopt_whole_program_optimization)
!endif

## Windows version (Windows 95, Internet Explorer 5.0)
ccdef_winver = -DWINVER=0x0400
ccdef_winver = $(ccdef_winver) -D_WIN32_WINDOWS=0x0400
ccdef_winver = $(ccdef_winver) -D_WIN32_WINNT=0x0400
ccdef_winver = $(ccdef_winver) -D_WIN32_IE=0x0500

## common defines
cvars = $(ccdef_win32) $(ccdef_winver)

## 
!if $(MIKTEX_RELEASE_STATE) < 4
ccopt_select_crt_mt_dll = $(ccopt_select_crt_mt_dll_retail)
!else
ccopt_select_crt_mt_dll = $(ccopt_select_crt_mt_dll_debug)
!endif

## 
!if $(MIKTEX_RELEASE_STATE) < 4
ccopt_select_crt_mt_static_lib = $(ccopt_select_crt_mt_static_lib_retail)
!else
ccopt_select_crt_mt_static_lib = $(ccopt_select_crt_mt_static_lib_debug)
!endif

## select run-time library (either DLL or static lib)
!if $(miktex_cc_use_crt_dll) > 0
crt = $(ccopt_select_crt_mt_dll)
!else
crt = $(ccopt_select_crt_mt_static_lib)
!endif

cvarsdll = $(cvars) $(crt)

## warning flags
!if $(miktex_cc_warnings_as_errors) > 0
warn = $(ccopt_lint_level_warnings) $(ccopt_warnings_as_errors)
!else if $(miktex_cc_no_warnings) > 0
warn = $(ccopt_disable_warnings)
!else
warn = $(ccopt_default_warnings)
!endif

## 64-bit portability
!if $(miktex_cc_64bit_portability) > 0
warn = $(warn) $(ccopt_64port)
!endif

## for loop conformance
!if $(miktex_cc_for_loop_conformance) > 0
warn = $(warn) $(ccopt_for_loop_conformance)
!endif

## ANSI conformance
!if $(miktex_cc_standard_conformance) > 0
warn = $(warn) $(ccopt_standard_conformance)
!endif

## generic compilation flags
cflags = $(ccopt_prevent_linking)
cflags = $(cflags) $(warn)
cflags = $(cflags) $(ccopt_quiet)
cflags = $(cflags) $(ccopt_eliminate_duplicate_strings)

## create program database files
cdebug = $(ccopt_create_pdb)

## state dependend flags
!if $(MIKTEX_RELEASE_STATE) == 4
cdebug = $(cdebug) $(ccopt_disable_optimizations)
!if $(miktex_cc_no_runtime_checks) == 0
cdebug = $(cdebug) $(ccopt_rtc_all)
!endif
!else ifdef PROFILE
cdebug = $(cdebug) $(ccopt_enable_penter_hook)
cdebug = $(cdebug) $(ccopt_debug_symbols_and_line_numbers)
cdebug = $(cdebug) $(coptflags)
!else ifdef TUNE
cdebug = $(cdebug) $(ccopt_enable_penter_hook)
cdebug = $(cdebug) $(ccopt_debug_symbols_and_line_numbers)
cdebug = $(cdebug) $(coptflags)
!else
cdebug = $(cdebug) $(coptflags)
!endif

!if $(miktex_cc_buffer_security_check) > 0
cdebug = $(cdebug) $(ccopt_buffer_security_check)
!endif

## exception handling support
cflagseh = $(ccopt_enable_exception_handling)

## RTTI support
cflagsrtti = $(ccopt_enable_rtti_support)

## fast call support
cflagsfastcall = $(ccopt_select_fastcall)

## separate functions for linker
cflagspackfunc = $(ccopt_enable_function_level_linking)

## state dependend version information
!if $(MIKTEX_RELEASE_STATE) == 0
release_info = $(ccdef_official) $(ccdef_final) $(ccdef_ndebug)
!else if $(MIKTEX_RELEASE_STATE) == 1
release_info = $(ccdef_official) $(ccdef_ndebug)
!else if $(MIKTEX_RELEASE_STATE) == 2
release_info = $(ccdef_official) $(ccdef_ndebug)
!else if $(MIKTEX_RELEASE_STATE) == 3
release_info = $(ccdef_official) $(ccdef_final) $(ccdef_ndebug)
!else if $(MIKTEX_RELEASE_STATE) == 4
release_info = $(ccdef_debug)
!endif

## use standard MiKTeX DLLs unless no_miktex_dlls is defined
!ifndef no_miktex_dlls
dlldefs = $(ccdef_miktex_dll) $(ccdef_app_dll)
dlldefs = $(dlldefs) $(ccdef_texmf_dll) $(ccdef_gnu_dll)
dlldefs = $(dlldefs) $(ccdef_regex_dll)
dlldefs = $(dlldefs) $(ccdef_gsoap_dll)
dlldefs = $(dlldefs) $(ccdef_mpm_dll)
dlldefs = $(dlldefs) $(ccdef_expat_dll) $(ccdef_popt_dll)
!endif

## MiKTeX specific defines
miktexvars = $(ccdef_miktex) $(dlldefs) $(release_info)

## common includes
incdirs = $(incdirs) $(ccinc_current_dir)
incdirs = $(incdirs) $(ccinc_lib)
incdirs = $(incdirs) $(ccinc_libapp)
incdirs = $(incdirs) $(ccinc_libdib)
incdirs = $(incdirs) $(ccinc_libdvi)
incdirs = $(incdirs) $(ccinc_libbz2)
incdirs = $(incdirs) $(ccinc_libgd)
incdirs = $(incdirs) $(ccinc_libgnu)
incdirs = $(incdirs) $(ccinc_libkps)
incdirs = $(incdirs) $(ccinc_libmd5)
incdirs = $(incdirs) $(ccinc_libmpm)
incdirs = $(incdirs) $(ccinc_libpng)
incdirs = $(incdirs) $(ccinc_libpopt)
incdirs = $(incdirs) $(ccinc_libtexmf)
incdirs = $(incdirs) $(ccinc_libpbm)
incdirs = $(incdirs) $(ccinc_libpgm)
incdirs = $(incdirs) $(ccinc_libpnm)
incdirs = $(incdirs) $(ccinc_libppm)
incdirs = $(incdirs) $(ccinc_netpbm)
incdirs = $(incdirs) $(ccinc_zlib)

## standard C-Compiler flags
cstandard = $(cflags) $(cdebug) $(cvarsdll) $(miktexvars) $(incdirs)

## standard C++-Compiler flags
cppstandard_seh = \
	$(cstandard) \
	$(ccopt_all_cpp) \
	$(ccopt_enable_synchronous_exception_handling) \

cppstandard_aeh = \
	$(cstandard) \
	$(ccopt_all_cpp) \
	$(ccopt_enable_asynchronous_exception_handling) \

cppstandard = $(cppstandard_seh)

#  ___________________________________________________________________________
#
#  Resource Compiler
#  ___________________________________________________________________________

## name of resource compiler
rc = rc

rcopt_output_file = -Fo

## common flags
rcflags = /r

## common defines
rcvars = /DWIN32 /D_WIN32

!if $(MIKTEX_RELEASE_STATE) == 0
rcvars = $(rcvars) /DOFFICIAL /DFINAL /DNDEBUG
!else if $(MIKTEX_RELEASE_STATE) == 1
rcvars = $(rcvars) /DOFFICIAL /DNDEBUG
!else if $(MIKTEX_RELEASE_STATE) == 2
rcvars = $(rcvars) /DOFFICIAL /DNDEBUG
!else if $(MIKTEX_RELEASE_STATE) == 3
rcvars = $(rcvars) /DOFFICIAL /DFINAL /DNDEBUG
!else if $(MIKTEX_RELEASE_STATE) == 4
rcvars = $(rcvars) /DOFFICIAL /DDEBUG
!endif

rcstandard = $(rcflags) $(rcvars) -I$(libdir)\include

#  ___________________________________________________________________________
#
#  Linker
#  ___________________________________________________________________________

## name of linker
link = link

## linker options
linkopt_build_dll = /DLL
linkopt_conapp = /SUBSYSTEM:CONSOLE
linkopt_delayload = -delayload:
linkopt_generate_debug_info = /DEBUG
#linkopt_generate_tuning_info = -debugtype:coff -debug:mapped,partial
linkopt_generate_tuning_info = 
linkopt_guiapp = /SUBSYSTEM:WINDOWS
linkopt_incremental_off = -INCREMENTAL:NO
linkopt_quiet = /NOLOGO
linkopt_set_checksum = /RELEASE
linkopt_whole_program_optimization = /LTCG

linkopt_output_file = -out:

## common flags
lflags = $(linkopt_incremental_off) $(linkopt_quiet)
!if $(MIKTEX_RELEASE_STATE) < 4
!if $(miktex_whole_program_optimization) > 0
lflags = $(lflags) $(linkopt_whole_program_optimization)
!endif
!ifndef TUNE
lflags = $(lflags) $(linkopt_set_checksum)
!endif
!endif

## console app flags
conlflags = $(lflags) $(linkopt_conapp)

## gui app flags
guilflags = $(lflags) $(linkopt_guiapp)

## dll flags
dlllflags = $(lflags) $(linkopt_build_dll)

## debug flags
!ifdef TUNE
ldebug = $(linkopt_generate_tuning_info)
!else
ldebug = $(linkopt_generate_debug_info)
!endif

## state dependend libraries
!ifdef PROFILE
optlibs = cap.lib
!else ifdef TUNE
optlibs = wst.lib
!else
optlibs =
!endif

## basic libraries
baselibs = kernel32.lib $(optlibs) advapi32.lib winspool.lib

## gui app libraries
winlibs = $(baselibs) user32.lib gdi32.lib comdlg32.lib

## console app libraries
conlibsdll = $(baselibs)

## gui app libraries
guilibsdll = $(winlibs)

## standard lib flags
lstandard = $(conlflags) $(ldebug)
dlllstandard = $(lflags) $(linkopt_build_dll) $(ldebug)

#  ___________________________________________________________________________
#
#  Program Names
#  ___________________________________________________________________________

##
bmeps = $(bindir)\bmeps

## install files
install = $(buildtoolsetcdir)\install
INSTALL_PROGRAM = $(install)
INSTALL_DATA = $(install)

## Perl
perl = perl
PERL = $(perl)

## Tangle (Pascal)
tangle = $(webdir)\$(outdir)\tangle.exe
TANGLE = $(tangle)

## Tangle (C/C++)
ctangle = $(bindir)\ctangle
CTANGLE = $(ctangle)

## Omega-enhanced Tangle (Pascal)
otangle = $(tangle) -omega
OTANGLE = $(otangle)

## DLL base utility
mkdllbases = $(bindir)\mkdllbases

## bin-to-C converter
bintoc = $(bindir)\bintoc

## etags
etags = etags

## make a directory path
mkpath = cmd /c mkdir
## </fixme>

## remove directory
rmdir = cmd /c rmdir /s /q

##
pushd = pushd
popd = popd

## Pascal-to-C converter
c4p = $(miktexsrcdir)\$(rel_c4pdir)\$(outdir)\c4p
C4P = $(c4p)

## TeX
tex = $(bindir)\tex
TEX = $(tex)

## Weave
weave = $(bindir)\weave

## LaTeX
latex = $(bindir)\tex "&latex"
LATEX = $(latex)

## IniTeXMF
initexmf = $(bindir)\initexmf

## Extract bounding box
ebb = $(bindir)\ebb

## TeXify
texify = $(bindir)\texify
texi2dvi = $(texify)

## ChangeLog utility
cvs2cl = $(perl) \local\bin\cvs2cl.pl

## BMP-to-PNM converter
!ifndef bmptopnm
bmptopnm = $(bindir)\bmptopnm
!endif

## PNM-to-TIFF converter
pnmtotiff = $(bindir)\pnmtotiff

## PNM-to-PNG converter
!ifndef pnmtopng
pnmtopng = $(bindir)\pnmtopng
!endif

## PNM-to-PS converter
pnmtops = $(bindir)\pnmtops

## PPM-to-PGM converter
ppmtopgm = $(bindir)\ppmtopgm


## MetaPost
mpost = $(bindir)\mpost

## Dvips
dvips = $(bindir)\dvips

## PLtoTF
pltotf = $(bindir)\pltotf
PLTOTF = $(pltotf)

## TFtoPL
tftopl = $(bindir)\tftopl
TFTOPL = $(tftopl)

## DVItype
dvitype = $(bindir)\dvitype
DVITYPE = $(dvitype)

## GFtype
gftype = $(bindir)\gftype
GFTYPE = $(gftype)

## tie multiple Web files together
tie = $(bindir)\tie
TIE = $(tie)

## Texinfo-to-X converter
makeinfo = $(bindir)\makeinfo
MAKEINFO = $(makeinfo)

## Texinfo-to-RTF converter
#makertf = $(bindir)\makertf
makertf = makertf

## Windows Help compiler
hcrtf = hcrtf
hc = $(hcrtf) -xn

## HTML Help compiler
hhc = hhc

## Bison
bison = bison
yacc = $(bison) --yacc

## Flex
flex = flex
lex = $(flex)

## Sed
sed = sed

## CVS
cvs = cvs

## xsltproc
xsltproc = xsltproc

## gsoap
soapcpp2 = soapcpp2
wsdl2h = wsdl2h


## ncftpput
ncftpput = C:\prog32\NcFTP\ncftpput

## rsync
rsync = rsync

## sitecopy
sitecopy = sitecopy

## ssh
ssh = ssh

## Openjade
openjade = openjade

## ImageMagick's convert utility
convert = convert.exe

## library utility
libtool = lib
libflags = /MACHINE:$(ARCH) /NOLOGO
!if $(miktex_whole_program_optimization) > 0
libflags = $(libflags) /LTCG
!endif
libopt_output_file = /OUT:

#  ___________________________________________________________________________
#
#  File Names
#  ___________________________________________________________________________

## name of MiKTeX makefile
miktex_mak = miktex.mak

## dll bases
dllbases = $(miktexsrcdir)\msvc\dlls.txt

## MiKTeX aliaser
alias_cpp = $(etcsrcdir)\alias.cpp

wrapper_cpp = $(etcsrcdir)\wrapper.cpp

# this one is deprecated:
wrapper_obj = $(texmflibdir)\$(outdir)\wrapper.obj

## list of METAFONT modes
mfmodes = mfmodes
MFMODES = $(mfmodes)

## DLL names; follow this naming convention:
##    MiKTeX-NAME-REV
## where:
##    NAME is the component name
##    REV is the API revision
## Don't forget to check these files as well:
## *.inc;*.mak;*.vcproj;dlls.txt;*.tpm	
app_dll_name =		MiKTeX-app-1
arctrl_dll_name =	MiKTeX-arctrl-1
bibtex_dll_name =	MiKTeX-bibtex-3
bmeps_dll_name =	MiKTeX-bmeps-3
bzip2_dll_name =	MiKTeX-bzip2-3
curl_dll_name =		MiKTeX-curl-1
dib_dll_name =		MiKTeX-dib-3
dvi_dll_name =		MiKTeX-dvi-3
dvicopy_dll_name =	MiKTeX-dvicopy-3
dvitomp_dll_name =	MiKTeX-dvitomp-3
dvitype_dll_name =	MiKTeX-dvitype-3
cjklatex_dll_name =	MiKTeX-cjklatex-2
expat_dll_name =	MiKTeX-expat-3
findtexmf_dll_name =	MiKTeX-findtexmf-3
freetype_dll_name =	MiKTeX-freetype-4
gd_dll_name =		MiKTeX-gd-2
gftodvi_dll_name =	MiKTeX-gftodvi-3
gftopk_dll_name =	MiKTeX-gftopk-3
gftype_dll_name =	MiKTeX-gftype-3
gnu_dll_name =		MiKTeX-gnu-3
gsoap_dll_name =	MiKTeX-gsoap-1
jpeg_dll_name =		MiKTeX-jpeg-3
kps_dll_name =		MiKTeX-kpseweb2cemu-3
makex_dll_name =	MiKTeX-make-3
mcd_dll_name =		MiKTeX-compilerdriver-3
md5_dll_name =		MiKTeX-md5-3
mf_dll_name =		MiKTeX-mf-3
mft_dll_name =		MiKTeX-mft-3
miktex_dll_name =	MiKTeX-core-3
mikui_dll_name =	MiKTeX-ui-3
mkfntmap_dll_name =	MiKTeX-mkfntmap-3
mp_dll_name =		MiKTeX-mp-3
mpm_dll_name =		MiKTeX-packagemanager-3
mspack_dll_name =	MiKTeX-mspack-1
mthelp_dll_name =	MiKTeX-mthelp-1
odvicopy_dll_name =	MiKTeX-odvicopy-3
ofm2opl_dll_name =	MiKTeX-ofm2opl-3
omega_dll_name =	MiKTeX-omega-3
omfonts_dll_name =	MiKTeX-omfonts-3
opl2ofm_dll_name =	MiKTeX-opl2ofm-3
ovf2ovp_dll_name =	MiKTeX-ovf2ovp-3
ovp2ovf_dll_name =	MiKTeX-ovp2ovf-3
pbm_dll_name =		MiKTeX-pbm-3
pdfetex_dll_name =	MiKTeX-pdfetex-3
pgm_dll_name =		MiKTeX-pgm-3
pltotf_dll_name =	MiKTeX-pltotf-3
png_dll_name =		MiKTeX-png-3
pnm_dll_name =		MiKTeX-pnm-3
pooltype_dll_name =	MiKTeX-pooltype-3
popt_dll_name =		MiKTeX-popt-3
ppm_dll_name =		MiKTeX-ppm-3
psres_dll_name =	MiKTeX-psres-3
regex_dll_name =	MiKTeX-regex-3
tangle_dll_name =	MiKTeX-tangle-3
tex_dll_name =		MiKTeX-tex-3
texmf_dll_name =	MiKTeX-texmf-3
tftopl_dll_name =	MiKTeX-tftopl-3
tiff_dll_name =		MiKTeX-tiff-3
vftovp_dll_name =	MiKTeX-vftovp-3
vptovf_dll_name =	MiKTeX-vptovf-3
weave_dll_name =	MiKTeX-weave-3
zlib_dll_name =		MiKTeX-zlib-3

## lib files
app_lib = $(applibdir)\$(outdir)\app.lib
arctrl_lib = $(arctrldir)\$(outdir)\arctrl.lib
bmeps_lib = $(bmepslibdir)\$(outdir)\libbmeps.lib
bz2_lib = $(bzip2dir)\$(outdir)\libbz2.lib
bz2_static_lib = $(bzip2staticdir)\$(outdir)\bz2-static.lib
curl_lib = $(curllibdir)\$(outdir)\libcurl.lib
curl_static_lib = $(curlstaticlibdir)\$(outdir)\curl-static.lib
dib_lib = $(diblibdir)\$(outdir)\dib.lib
dvi_lib = $(dvilibdir)\$(outdir)\dvi.lib
expat_lib = $(expatlibdir)\$(outdir)\expat.lib
expat_static_lib = $(expatstaticlibdir)\$(outdir)\expat-static.lib
fofi_static_lib = $(fofistaticlibdir)\$(outdir)\fofi.lib
freetype_lib = $(freetypelibdir)\arch\win32\$(outdir)\freetype.lib
gd_lib = $(gdlibdir)\$(outdir)\gd.lib
gnu_lib = $(gnulibdir)\$(outdir)\gnu.lib
gnu_static_lib = $(gnustaticlibdir)\$(outdir)\gnu-static.lib
goo_static_lib = $(goostaticlibdir)\$(outdir)\goo.lib
gsoap_lib = $(gsoapdir)\$(outdir)\gsoap.lib
gsoap_static_lib = $(gsoapstaticdir)\$(outdir)\gsoap-static.lib
jpeg_lib = $(jpeglibdir)\$(outdir)\libjpeg.lib
kps_lib = $(kpslibdir)\$(outdir)\kps.lib
makex_lib = $(makexlibdir)\$(outdir)\makex.lib
mcd_lib = $(mcdlibdir)\$(outdir)\mcd.lib
md5_lib = $(md5libdir)\$(outdir)\md5.lib
md5_static_lib = $(md5staticlibdir)\$(outdir)\md5-static.lib
miktex_lib = $(liboutdir)\core.lib
miktex_static_lib = $(staticlibdir)\$(outdir)\core-static.lib
mikui_lib = $(mikuilibdir)\$(outdir)\$(mikui_dll_name).lib
mpm_lib = $(mpmlibdir)\$(outdir)\mpm.lib
mpm_static_lib = $(mpmstaticlibdir)\$(outdir)\mpm-static.lib
mspack_lib = $(mspacklibdir)\$(outdir)\mspack.lib
mspack_static_lib = $(mspackstaticlibdir)\$(outdir)\mspack-static.lib
mthelp_lib = $(mthelplibdir)\$(outdir)\mthelp.lib
pbm_lib = $(pbmlibdir)\$(outdir)\libpbm.lib
pgm_lib = $(pgmlibdir)\$(outdir)\libpgm.lib
png_lib = $(pnglibdir)\$(outdir)\libpng.lib
pnm_lib = $(pnmlibdir)\$(outdir)\libpnm.lib
popt_lib = $(poptlibdir)\$(outdir)\popt.lib
popt_static_lib = $(poptstaticlibdir)\$(outdir)\popt-static.lib
ppm_lib = $(ppmlibdir)\$(outdir)\libppm.lib
psres_lib = $(miktexsrcdir)\ps2pk\psres\$(outdir)\psres.lib
regex_lib = $(gnulibdir)\$(outdir)\regex.lib
texmf_lib = $(texmflibdir)\$(outdir)\texmf.lib
tiff_lib = $(tifflibdir)\$(outdir)\libtiff.lib
xpdf_static_lib = $(xpdfstaticlibdir)\$(outdir)\xpdf.lib
zlib_lib = $(zlibdir)\$(outdir)\zlib.lib
zlib_static_lib = $(zlibstaticlibdir)\$(outdir)\zlib-static.lib

!if $(MIKTEX_RELEASE_STATE) == 4
mfc_lib = mfc71d.lib
!else
mfc_lib = mfc71.lib
!endif

#  ___________________________________________________________________________
#
#  makedepend
#  ___________________________________________________________________________

fixdep = sed -i \
	-e s,$(miktexsrcdir:\=/),$$(miktexsrcdir),g \
	-e s,^__xx__.*\\\\\\([A-Za-z0-9_-]\\+\\.obj\\):,$$(outdir)\\\\\\1:, \
	-e s,^__xx__\\([A-Za-z0-9_-]\\+\\.obj\\):,$$(outdir)\\\\\\1:, \
			miktex.mak

MAKEDEPEND = makedepend -f $(miktex_mak) -p__xx__ -Y \
		$(miktexvars) \
		-D__cplusplus \
		-I$(srcdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_bzip2dir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_diblibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_dvilibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_libdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_applibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_curllibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_expatlibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_libgddir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_gnulibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_gsoapdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_jpeglibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_kpslibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_md5libdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_mpmlibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_mspacklibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_pnglibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_poptlibdir:\=/) \
		-I$(miktexsrcdir:\=/)/$(rel_texmflibdir:\=/)/include \
		-I$(miktexsrcdir:\=/)/$(rel_tifflibdir) \
		-I$(miktexsrcdir:\=/)/$(rel_netpbmdir:\=/)/pbm \
		-I$(miktexsrcdir:\=/)/$(rel_netpbmdir:\=/)/pgm \
		-I$(miktexsrcdir:\=/)/$(rel_netpbmdir:\=/)/pnm \
		-I$(miktexsrcdir:\=/)/$(rel_netpbmdir:\=/)/ppm \
		-I$(miktexsrcdir:\=/)/$(rel_zlibdir:\=/) \

#  ___________________________________________________________________________
#
#  update_copyright_year
#  ___________________________________________________________________________

update_copyright_year = \
  $(perl) $(miktexsrcdir)\util\global-replace \
  "s:^/\*(.*)\n+   Copyright \(C\) [0-9-]+:/*$$1\n\n   Copyright (C) 1996-2003:" 

#  ___________________________________________________________________________
#
#  suffixes
#  ___________________________________________________________________________

.SUFFIXES: .cc
